YUI.add("mojito-util",function(Y,NAME){var META_AUTOCLOBBER=["content-type"],META_EXCLUDE=["view"],META_ATOMIC=["content-type"];function arrayContainsLowerCase(a,obj){var i=a.length,selector=obj.toLowerCase();i-=1;while(i>=0){if(a[i].toLowerCase()===selector){return true}i-=1}return false}function shouldAutoClobber(k){return arrayContainsLowerCase(META_AUTOCLOBBER,k)}function isExcluded(k){return arrayContainsLowerCase(META_EXCLUDE,k)}function isAtomic(k){return arrayContainsLowerCase(META_ATOMIC,k)}Y.namespace("mojito").util={htmlEntitiesToUnicode:function(obj){if(Y.Lang.isString(obj)){return obj.replace(/</g,"\\u003C").replace(/>/g,"\\u003E").replace(/&/g,"\\u0026").replace(/'/g,"\\u0027").replace(/"/g,"\\u0022")}return obj},unicodeToHtmlEntities:function(obj){if(Y.Lang.isString(obj)){return obj.replace(/\\u003C/g,"<").replace(/\\u003E/g,">").replace(/\\u0026/g,"&").replace(/\\u0027/g,"'").replace(/\\u0022/g,'"')}return obj},cleanse:function(obj,escape){var func,clean,len,i;if(escape){if(typeof escape==="function"){func=escape}else{throw new Error("Invalid escape function: "+escape)}}func=func||this.htmlEntitiesToUnicode;if(Y.Lang.isString(obj)){return func(obj)}if(Y.Lang.isArray(obj)){clean=[];len=obj.length;for(i=0;i<len;i+=1){clean.push(this.cleanse(obj[i],func))}return clean}if(Y.Lang.isObject(obj)){clean={};for(i in obj){if(obj.hasOwnProperty(i)){clean[this.cleanse(i,func)]=this.cleanse(obj[i],func)}}return clean}return obj},uncleanse:function(obj){return this.cleanse(obj,this.unicodeToHtmlEntities)},copy:function(oldObj){var newObj,key,len,copy=Y.mojito.util.copy;if(!oldObj||typeof oldObj!=="object"){return oldObj}if(Y.Lang.isArray(oldObj)){newObj=[];len=oldObj.length;for(key=0;key<len;key+=1){newObj[key]=copy(oldObj[key])}return newObj}newObj={};for(key in oldObj){if(oldObj.hasOwnProperty(key)){newObj[key]=copy(oldObj[key])}}return newObj},heir:function(o){function F(){}F.prototype=o;return new F},blend:function(base,overlay){var dest,i,slot,copy=Y.mojito.util.copy,blend=Y.mojito.util.blend;if(base===null||base===undefined){return copy(overlay)}if(overlay===null||overlay===undefined){return copy(base)}if(Y.Lang.isArray(overlay)){if(Y.Lang.isArray(base)){return Y.Array.unique(base.concat(overlay))}Y.log("Type mismatch for array merge. Dropping value from base: "+JSON.stringify(base),"warn",NAME);return overlay.slice(0)}dest={};for(i in overlay){if(overlay.hasOwnProperty(i)){if(base.hasOwnProperty(i)){slot=overlay[i];if(Y.Lang.isObject(slot)){dest[i]=blend(base[i],slot)}else{dest[i]=slot}}else{dest[i]=copy(overlay[i])}}}if(Y.Lang.isObject(base)&&!Y.Lang.isArray(base)){for(i in base){if(base.hasOwnProperty(i)){if(!dest.hasOwnProperty(i)){dest[i]=copy(base[i])}}}}return dest},blend3:function(lowest,medium,highest){var dest,key,val,useMedium,useLowest,copy=Y.mojito.util.copy,blend2=Y.mojito.util.blend,blend3=Y.mojito.util.blend3;if(highest===null||highest===undefined){return blend2(lowest,medium)}if(Y.Lang.isArray(highest)){if(Y.Lang.isArray(medium)){if(Y.Lang.isArray(lowest)){dest=lowest.concat(medium,highest)}else{dest=medium.concat(highest)}}else{dest=highest.slice(0)}return Y.Array.unique(dest)}dest={};useMedium=true;useLowest=true;if(!Y.Lang.isObject(medium)||Y.Lang.isArray(medium)){useMedium=false;useLowest=false}if(useLowest&&(!Y.Lang.isObject(lowest)||Y.Lang.isArray(lowest))){useLowest=false}for(key in highest){if(highest.hasOwnProperty(key)){val=highest[key];if(Y.Lang.isObject(val)){if(useMedium&&medium.hasOwnProperty(key)){if(useLowest&&lowest.hasOwnProperty(key)){dest[key]=blend3(lowest[key],medium[key],val)}else{dest[key]=blend2(medium[key],val)}}else{if(useLowest&&lowest.hasOwnProperty(key)){dest[key]=blend2(lowest[key],val)}else{dest[key]=copy(val)}}}else{dest[key]=copy(val)}}}if(useMedium){for(key in medium){if(medium.hasOwnProperty(key)){if(!dest.hasOwnProperty(key)){val=medium[key];if(Y.Lang.isObject(val)){if(useLowest&&lowest.hasOwnProperty(key)){dest[key]=blend2(lowest[key],val)}else{dest[key]=copy(val)}}else{dest[key]=val}}}}}if(useLowest){for(key in lowest){if(lowest.hasOwnProperty(key)){if(!dest.hasOwnProperty(key)){dest[key]=copy(lowest[key])}}}}return dest},mergeRecursive:function(dest,src,typeMatch){var p,arr;if(Y.Lang.isArray(src)){if(!Y.Lang.isArray(dest)){throw new Error("Type mismatch for object merge.")}arr=dest.slice(0);arr.push.apply(arr,src);arr=Y.Array.unique(arr);dest.length=0;dest.push.apply(dest,arr)}else{for(p in src){if(src.hasOwnProperty(p)){if(src[p]&&src[p].constructor===Object){if(!dest[p]){dest[p]={}}dest[p]=this.mergeRecursive(dest[p],src[p])}else{if(dest[p]&&typeMatch){if(typeof dest[p]===typeof src[p]){dest[p]=src[p]}}else if(typeof src[p]!=="undefined"){if(src[p]===null){if(typeof dest[p]==="undefined"){dest[p]=src[p]}}else{dest[p]=src[p]}}}}}}return dest},metaMerge:function(to,from,clobber,__internal){var k,tv,fv,internal=__internal;for(k in from){if(from.hasOwnProperty(k)){if(internal||!isExcluded(k)){fv=from[k];tv=to[k];if(!tv){to[k]=fv}else if(Y.Lang.isArray(fv)){if(!Y.Lang.isArray(tv)){throw new Error("Meta merge error."+" Type mismatch between mojit metas.")}if(shouldAutoClobber(k)){if(isAtomic(k)){to[k]=[fv[fv.length-1]]}else{to[k]=fv}}else{Y.mojito.util.mergeRecursive(tv,fv)}}else if(Y.Lang.isObject(fv)){if(Y.Lang.isObject(tv)){to[k]=Y.mojito.util.metaMerge(tv,fv,clobber,true)}else if(Y.Lang.isNull(tv)||Y.Lang.isUndefined(tv)){to[k]=fv}else{throw new Error("Meta merge error."+" Type mismatch between mojit metas.")}}else if(clobber){to[k]=fv}}}}return to},iOSUrl:function(url){if(typeof window==="undefined"){return url}if(window.location.href.indexOf("file://")===0&&window.location.href.indexOf("/Applications/")>0&&window.location.href.indexOf(".app/")>0){if(url.charAt(0)==="/"){url=url.slice(1)}}return url},createCacheKey:function(obj){var key;try{key=Y.JSON.stringify(obj)}catch(err){key=Y.guid()}return key},findClosestLang:function(want,have){var p,parts,test;parts=want?want.split("-"):[];for(p=want.length;p>0;p-=1){test=parts.slice(0,p).join("-");if(have[test]){return test}}return""}}},"0.1.0",{requires:["array-extras","json-stringify","mojito"]});
